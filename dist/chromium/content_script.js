"use strict";(()=>{var h="configV1",p=async()=>({showGoogleButtonOnBing:!0,showBingButtonOnGoogle:!0,...(await chrome.storage.sync.get(h))[h]});var w=e=>e.replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2f;");var x=async(e,t)=>await new Promise((r,m)=>{chrome.runtime.sendMessage({method:e,args:[...t]},s=>{!s||s.code!==200?m(s?.msg):r(s.data)})}),f=async e=>{try{return await x("openUrlInSameTab",[{url:e}])}catch{location.href=e}},l={attributes:!0,childList:!0,subtree:!0};var b=(e,t,r)=>{location.href.startsWith("https://www.bing.com/search?")&&new MutationObserver((m,s)=>{if(!document.getElementById("sb_form")||(s.disconnect(),t(document.body).on("click","a.b_logoArea",function(o){t(this).attr("href","/").attr("target","_self")}),!e.showGoogleButtonOnBing))return;let c=t("#sb_form_q"),g=c.val(),a=t(`
      <a href="https://www.google.com/search?q=${encodeURIComponent(w(g))}" target="google" tabindex="0" rel="noopener noreferrer nofollow" title="search with Google">
        <img src="${chrome.runtime.getURL("images/google.png")}" alt="google" style="width: 100%;display: block;">
      </a>`).css({position:"absolute",left:0,top:0,width:"70px",height:"23px",display:"inline-block","z-index":999,transition:"all .3s",transform:"translate3d(835px, 13px, 0px)","will-change":"transform",cursor:"pointer"});t("#sb_form").css("position","relative").prepend(a),a.on("click",async function(o){o.preventDefault();let n="";n||(n=c.val().trim());let i=`https://www.google.com/search?q=${encodeURIComponent(n)}`;t(this).attr("href",i),await f(i)}),location.search.includes("showconv=1")&&(a.css("display","none"),setTimeout(()=>{a.css("display","inline-block")},1200));let u=()=>{let o=t("#b-scopeListItem-conv");if(o.hasClass("b_active")){let n=0;o.offset().left?n=o.offset().left+o.width()+30:n=350,a.css({transform:`translate3d(${n}px, 15px, 0)`})}else a.css({transform:"translate3d(835px, 15px, 0)"})};u(),new MutationObserver((o,n)=>{for(let i of o)i.target&&i.target.id==="b-scopeListItem-conv"&&u()}).observe(document.getElementById("b_header"),l)}).observe(r,l)};var d=(e,t,r)=>{e.showBingButtonOnGoogle&&(location.href.startsWith("https://www.google.com/search?")||location.href.startsWith("https://www.google.com.hk/search?"))&&new MutationObserver((m,s)=>{let c='[action="/search"]';if(!t(c).length)return;s.disconnect();let g=t(c),a=g.find('[name="q"]'),u=g.find('button[type="submit"]'),o=t(`
      <a href="https://www.bing.com/search?q=Bing+AI&showconv=1" rel="noopener noreferrer nofollow" target="bing" title="search with New Bing">
        <img src="${chrome.runtime.getURL("images/bing-chat.svg")}" style="display: block; width: 24px;" alt="bing" />
      </a>`).css({width:"40px",display:"flex",position:"relative","z-index":999,cursor:"pointer","justify-content":"center",margin:"0 10px 0 -10px"});u.after(o),o.on("click",async function(n){n.preventDefault();let i=`https://www.bing.com/search?q=${encodeURIComponent(a.val())}&showconv=1`;t(this).attr("href",i),await f(i)})}).observe(r,l)};(async(e,t)=>{let r=await p();location.hostname==="www.bing.com"&&b(r,e,t),location.hostname.startsWith("www.google.")&&d(r,e,t)})(window.Zepto,document.documentElement);})();
