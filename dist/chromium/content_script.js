"use strict";(()=>{var d="configV1",w=async()=>({showGoogleButtonOnBing:!0,showBingButtonOnGoogle:!0,...(await chrome.storage.sync.get(d))[d]});var b=o=>o.replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2f;");var f=async(o,t=[])=>await new Promise((s,h)=>{chrome.runtime.sendMessage({method:o,args:[...t]},a=>{!a||a.code!==200?h(a?.msg):s(a.data)})}),m=async o=>{try{return await f("openUrlInSameTab",[{url:o}])}catch{location.href=o}},g={attributes:!0,childList:!0,subtree:!0};var x=async(o,t,s)=>{location.href.startsWith("https://www.bing.com/search?")&&new MutationObserver((h,a)=>{if(!document.getElementById("sb_form")||(a.disconnect(),f("getNotification").then(e=>{if(!e)return;let r=t(document.body),n=t("<div/>").css({width:"100%",height:40,border:"1px solid #590727",background:"#58070d",position:"fixed",top:0,fontSize:"12px",lineHeight:"40px",textAlign:"center",zIndex:99999,whiteSpace:"nowrap",textOverflow:"ellipsis",display:"block !important"}),l=()=>{n.remove(),r.css("padding-top",null)},v=t(`<a style="color:#fff; background:url(${chrome.runtime.getURL("images/bing_32x32.png")}) no-repeat left 0; background-size: 12px; padding-left: 20px" href="${e.html_url}" target="_blank" rel="nofollow noreferrer">${e.title}</a>`).on("click",l),T=t('<a href="#" style="background:#58070d; color:#fff; cursor:pointer;padding: 0 68px 0 18px;position: absolute;right:0" title="no reminder">\u2715</a>').on("click",I=>{I.preventDefault(),confirm("Are you sure never see this notice again?")&&f("hideNotification"),l()});n.append(v).append(T),r.append(n).css("padding-top",40)}),t(document.body).on("click","a.b_logoArea",e=>{t(e.currentTarget).attr("href","/").attr("target","_self")}),!o.showGoogleButtonOnBing))return;let c=t("#sb_form_q"),u=c.val(),i=t(`
      <a href="https://www.google.com/search?q=${encodeURIComponent(b(u))}" target="google" tabindex="0" rel="noopener noreferrer nofollow" title="search with Google">
        <img src="${chrome.runtime.getURL("images/google.png")}" alt="google" style="width: 100%;display: block;">
      </a>`).css({position:"absolute",left:0,top:0,width:"70px",height:"23px",display:"inline-block","z-index":999,transition:"all .3s",transform:"translate3d(835px, 13px, 0px)","will-change":"transform",cursor:"pointer"});t("#sb_form").css("position","relative").prepend(i),i.on("click",async e=>{let r=t(e.currentTarget);e.preventDefault();let n="";n||(n=c.val().trim());let l=`https://www.google.com/search?q=${encodeURIComponent(n)}`;r.attr("href",l),await m(l)}),location.search.includes("showconv=1")&&(i.css("display","none"),setTimeout(()=>{i.css("display","inline-block")},1200));let p=()=>{let e=t("#b-scopeListItem-conv");if(e.hasClass("b_active")){let r=0;e.offset().left?r=e.offset().left+e.width()+30:r=350,i.css({transform:`translate3d(${r}px, 15px, 0)`})}else i.css({transform:"translate3d(835px, 15px, 0)"})};p(),new MutationObserver((e,r)=>{for(let n of e)n.target&&n.target.id==="b-scopeListItem-conv"&&p()}).observe(document.getElementById("b_header"),g)}).observe(s,g)};var y=async(o,t,s)=>{o.showBingButtonOnGoogle&&(location.href.startsWith("https://www.google.com/search?")||location.href.startsWith("https://www.google.com.hk/search?"))&&new MutationObserver((h,a)=>{let c='[action="/search"]';if(!t(c).length)return;a.disconnect();let u=t(c),i=u.find('[name="q"]'),p=u.find('button[type="submit"]'),e=t(`
      <a href="https://www.bing.com/search?q=Bing+AI&showconv=1" rel="noopener noreferrer nofollow" target="bing" title="search with New Bing">
        <img src="${chrome.runtime.getURL("images/bing-chat.svg")}" style="display: block; width: 24px;" alt="bing" />
      </a>`).css({width:"40px",display:"flex",position:"relative","z-index":999,cursor:"pointer","justify-content":"center",margin:"0 10px 0 -10px"});p.after(e),e.on("click",async function(r){r.preventDefault();let n=`https://www.bing.com/search?q=${encodeURIComponent(i.val())}&showconv=1`;t(this).attr("href",n),await m(n)})}).observe(s,g)};(async(o,t)=>{let s=await w();location.hostname==="www.bing.com"&&await x(s,o,t),location.hostname.startsWith("www.google.")&&await y(s,o,t)})(window.Zepto,document.documentElement);})();
