"use strict";(()=>{var w="configV1",b=async()=>({showGoogleButtonOnBing:!0,showBingButtonOnGoogle:!0,...(await chrome.storage.sync.get(w))[w]});var y=n=>String(n).replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2f;");var f="New Bing Anywhere";var p=async(n,e=[])=>await new Promise((s,l)=>{chrome.runtime.sendMessage({method:n,args:[...e]},i=>{!i||i.code!==200?l(i?.msg):s(i.data)})}),d=async n=>{try{return await p("openUrlInSameTab",[{url:n}])}catch{location.href=n}},g={attributes:!0,childList:!0,subtree:!0};var x=async(n,e,s)=>{location.href.startsWith("https://www.bing.com/search?")&&new MutationObserver((l,i)=>{if(!document.getElementById("sb_form")||(i.disconnect(),p("getNotification").then(t=>{if(!t)return;let o=e(document.body),r=e("<div/>").css({width:"100%",height:40,border:"1px solid #590727",background:"#58070d",position:"fixed",top:0,fontSize:"12px",lineHeight:"40px",textAlign:"center",zIndex:99999,whiteSpace:"nowrap",textOverflow:"ellipsis",display:"block !important"}),c=()=>{r.remove(),o.css("padding-top",null)},T=e(`<a style="color:#fff; background:url(${chrome.runtime.getURL("images/bing_32x32.png")}) no-repeat left 0; background-size: 12px; padding-left: 20px" href="${t.html_url}" target="_blank" rel="nofollow noreferrer">${t.title}</a>`).on("click",c),B=e('<a href="#" style="background:#58070d; color:#fff; cursor:pointer;padding: 0 68px 0 18px;position: absolute;right:0" title="no reminder">\u2715</a>').on("click",N=>{N.preventDefault(),confirm("Are you sure never see this notice again?")&&p("hideNotification"),c()});r.append(T).append(B),o.append(r).css("padding-top",40)}),e(document.body).on("click","a.b_logoArea",t=>{e(t.currentTarget).attr("href","/").attr("target","_self")}),!n.showGoogleButtonOnBing))return;let u=e("#sb_form_q"),m=u.val(),a=e(`
      <a href="https://www.google.com/search?q=${encodeURIComponent(y(m))}" target="google" tabindex="0" rel="noopener noreferrer nofollow" title="search with Google">
        <img src="${chrome.runtime.getURL("images/google.png")}" alt="google" style="width: 100%;display: block;">
      </a>`).css({position:"absolute",left:0,top:0,width:"70px",height:"23px",display:"inline-block","z-index":999,transition:"all .3s",transform:"translate3d(835px, 13px, 0px)","will-change":"transform",cursor:"pointer"});e("#sb_form").css("position","relative").prepend(a),a.on("click",async t=>{let o=e(t.currentTarget);t.preventDefault();let r="";r||(r=u.val().trim());let c=`https://www.google.com/search?q=${encodeURIComponent(r)}`;o.attr("href",c),await d(c)}),location.search.includes("showconv=1")&&(a.css("display","none"),setTimeout(()=>{a.css("display","inline-block")},1200));let h=()=>{let t=e("#b-scopeListItem-conv");if(t.hasClass("b_active")){let o=0;t.offset().left?o=t.offset().left+t.width()+30:o=350,a.css({transform:`translate3d(${o}px, 15px, 0)`})}else a.css({transform:"translate3d(835px, 15px, 0)"})};h(),new MutationObserver((t,o)=>{for(let r of t)r.target&&r.target.id==="b-scopeListItem-conv"&&h()}).observe(document.getElementById("b_header"),g)}).observe(s[0],g)};var v=async(n,e,s)=>{n.showBingButtonOnGoogle&&(location.href.startsWith("https://www.google.com/search?")||location.href.startsWith("https://www.google.com.hk/search?"))&&new MutationObserver((l,i)=>{let u='[action="/search"]';if(!e(u).length)return;i.disconnect();let m=e(u),a=m.find('[name="q"]'),h=m.find('button[type="submit"]'),t=e(`
      <a href="https://www.bing.com/search?q=Bing+AI&showconv=1" rel="noopener noreferrer nofollow" target="bing" title="search with New Bing">
        <img src="${chrome.runtime.getURL("images/bing-chat.svg")}" style="display: block; width: 24px;" alt="bing" />
      </a>`).css({width:"40px",display:"flex",position:"relative","z-index":999,cursor:"pointer","justify-content":"center",margin:"0 10px 0 -10px"});h.after(t),t.on("click",async o=>{let r=e(o.currentTarget);o.preventDefault();let c=`https://www.bing.com/search?q=${encodeURIComponent(a.val())}&showconv=1`;r.attr("href",c),await d(c)})}).observe(s[0],g)};(async n=>{let e=n(document.documentElement);if(e.find(`meta[name="${f}"]`).length)return;let s=n(`<meta name="${f}" />`);e.prepend(s),p("getEnv").then(i=>{s.attr("content",i.version)});let l=await b();location.hostname==="www.bing.com"&&await x(l,n,e),location.hostname.startsWith("www.google.")&&await v(l,n,e)})(window.Zepto);})();
